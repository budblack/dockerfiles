worker_processes  1;
events {
  worker_connections  1024;
}

stream {
    upstream gcloudss0 {
        hash $remote_addr consistent;
        server g.budblack.me:50001;
    }
    upstream gcloudss1 {
        hash $remote_addr consistent;
        server g.denger.cc:50001;
    }
    upstream gcloudss2 {
        hash $remote_addr consistent;
        server 45.63.50.93:8888;
    }
  
    server {
        listen 9599;
        proxy_connect_timeout 1s;
        proxy_timeout 3s;
        proxy_pass gcloudss0;
    }
    server {
        listen 9598;
        proxy_connect_timeout 1s;
        proxy_timeout 3s;
        proxy_pass gcloudss1;
    }
    server {
        listen 9597;
        proxy_connect_timeout 1s;
        proxy_timeout 3s;
        proxy_pass gcloudss2;
    }
}

http {  
  include       mime.types;  
  default_type  application/octet-stream;  
  sendfile        on;  
  keepalive_timeout  65;  
  
# 首页
  server
    {
      listen 80;
      server_name 119.23.173.49 o.ot.budblack.me atech.ltd www.atech.ltd o.bianbiankj.com www.o.bianbiankj.com;
      location / {
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://10.80.232.165:9001;
      }
    }

# 旗袍项目 2017年10月07日 签约
  server
    {
      listen 80;
      server_name che.ot.budblack.me che.o.bianbiankj.com;
      location / {
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://10.80.232.165:9011;
      }
    }
  
  # 模型网盘项目 2017年10月17日 创建
  server
    {
      listen 80;
      server_name mose.ot.budblack.me;
      location / {
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://10.80.232.165:9021;
      }
    }
  
  # 网络资源离线下载 2017年11月06日 创建
  server
    {
      listen 80;
      server_name fetch.ot.budblack.me fetch.tool.budblack.me;
      location / {
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://10.80.232.165:9031;
      }
    }
  
  # rutorrent bt离线下载用, 2017年11月10日 创建
  server
    {
      listen 80;
      server_name rutorrent.ot.budblack.me rutorrent.tool.budblack.me;
      location / {
        proxy_redirect off;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;
        proxy_pass http://10.80.232.165:9041;
        auth_basic "EI PSY CONGROO.";
        auth_basic_user_file /etc/nginx/htpasswd; 
      }
    }
}
